<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="final.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE> INVERSE_MODELING</TITLE>
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<HR><P> | <A HREF="final-45.html">Next</A>|| <A HREF="final-43.html">Previous</A> || <A HREF="final.html">Top</A>  | </P>

</DIV>
<H1 CLASS="FM3d-order-node">
<A NAME="pgfId-254827"></A><STRONG CLASS="Bold">
INVERSE_MODELING</STRONG><A NAME="11066"></A></H1>
<P CLASS="BodyText">
<A NAME="pgfId-254828"></A>This keyword data block is used to specify the information needed for an inverse modeling calculation. Inverse modeling attempts to determine sets of mole transfers of phases that account for changes in water chemistry between one or a mixture of initial water compositions and a final water composition. Isotope mole balance, but not isotope fractionation, can be included in the calculations. The data block includes definition of the solutions, phases, and uncertainty limits used in the calculations.</P>
<DIV>
<H3 CLASS="FM4thOrderHeading">
<A NAME="pgfId-254829"></A><STRONG CLASS="Bold">
Example data block</STRONG></H3>
<PRE CLASS="Body-line"><A NAME="pgfId-254830"></A>Line 0:  <STRONG CLASS="Bold">INVERSE_MODELING</STRONG> 1
<A NAME="pgfId-254831"></A>Line 1:       <STRONG CLASS="Bold">-solutions</STRONG>       10 3 5
<A NAME="pgfId-254832"></A>Line 2:       <STRONG CLASS="Bold">-uncertainty</STRONG>     0.02   0.04
<A NAME="pgfId-254833"></A>Line 3:       <STRONG CLASS="Bold">-phases</STRONG> 
<A NAME="pgfId-254834"></A>Line 4a:           Calcite     force  pre   13C   -1.0   1
<A NAME="pgfId-254835"></A>Line 4b:           Anhydrite   force  dis   34S   13.5   2
<A NAME="pgfId-254836"></A>Line 4c:           CaX2
<A NAME="pgfId-254837"></A>Line 4d:           NaX
<A NAME="pgfId-254838"></A>Line 5:       <STRONG CLASS="Bold">-balances</STRONG> 
<A NAME="pgfId-254839"></A>Line 6a            pH          0.1
<A NAME="pgfId-254840"></A>Line 6b:           Ca          0.01     -0.005
<A NAME="pgfId-254841"></A>Line 6c:           Alkalinity  -1.0e-6
<A NAME="pgfId-254842"></A>Line 6d:           Fe          0.05     0.1      0.2
<A NAME="pgfId-254843"></A>Line 7:       <STRONG CLASS="Bold">-isotopes</STRONG>
<A NAME="pgfId-254844"></A>Line 8a:            13C        0.05     0.1      0.05 
<A NAME="pgfId-254845"></A>Line 8b:            34S        1.0
<A NAME="pgfId-254846"></A>Line 9:       <STRONG CLASS="Bold">-range </STRONG>          10000
<A NAME="pgfId-254847"></A>Line 10:      <STRONG CLASS="Bold">-minimal</STRONG>
<A NAME="pgfId-254848"></A>Line 11:      <STRONG CLASS="Bold">-tolerance</STRONG>       1e-10
<A NAME="pgfId-254849"></A>Line 12:      <STRONG CLASS="Bold">-force_solutions </STRONG>true     false
<A NAME="pgfId-254850"></A>Line 13:      <STRONG CLASS="Bold">-uncertainty_water  </STRONG>0.55  # moles (&#126;1%) 
<A NAME="pgfId-254851"></A>Line 14:      <STRONG CLASS="Bold">-mineral_water  </STRONG> false</PRE>
</DIV>
<DIV>
<H3 CLASS="FM4thOrderHeading">
<A NAME="pgfId-254852"></A><STRONG CLASS="Bold">
Explanation</STRONG></H3>
<P CLASS="Body-indent">
<A NAME="pgfId-254853"></A>Line 0: <STRONG CLASS="Bold">
INVERSE_MODELING</STRONG> [<EM CLASS="Emphasis">
number</EM>
] [<EM CLASS="Emphasis">
description</EM>
]</P>
<P CLASS="Body1">
<A NAME="pgfId-254854"></A><STRONG CLASS="Bold">
INVERSE_MODELING</STRONG> is the keyword for the data block. </P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254855"></A><EM CLASS="Emphasis">
number</EM>
--Positive number to designate the following inverse-modeling definition. Default is 1. </P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254856"></A><EM CLASS="Emphasis">
description</EM>
--Optional comment that describes the inverse-modeling calculation.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254857"></A>Line 1: <STRONG CLASS="Bold">
-solutions</STRONG><EM CLASS="Emphasis">
, list of solution numbers</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254858"></A><STRONG CLASS="Bold">
-solutions</STRONG>--Identifier that indicates a list of solution numbers follows on the same line. Optionally, <STRONG CLASS="Bold">
sol</STRONG>, or <STRONG CLASS="Bold">
-s</STRONG>[<STRONG CLASS="Bold">
olutions</STRONG>]. Note the hyphen is required to avoid conflict with the keyword <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG>.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254859"></A><EM CLASS="Emphasis">
list of solution numbers</EM>
--List of solution numbers to use in mole-balance calculations. At least two solution numbers are required and these solutions must be defined by <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG> input or by <STRONG CLASS="Bold">
<A HREF="final-53.html#81857" CLASS="XRef">SAVE</A></STRONG> after a batch-reaction calculation in the current or previous simulations. The final solution number is listed last, all but the final solution are termed &quot;initial solutions&quot;. If more than one initial solution is listed, the initial solutions are assumed to mix to form the final solution. The mixing proportions of the initial solutions are calculated in the modeling process. In the example data block (line 1), solution 5 is to be made by mixing solutions 10 and 3 in combination with phase mole transfers.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254860"></A>Line 2: <STRONG CLASS="Bold">
-uncertainty</STRONG><EM CLASS="Emphasis">
, list of uncertainty limits</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254861"></A><STRONG CLASS="Bold">
-uncertainty</STRONG>--Identifier that indicates a list of default uncertainty limits for each solution follows on the same line. The uncertainty limits defined with <STRONG CLASS="Bold">
-uncertainty</STRONG> do not apply to pH; default for pH is 0.05 pH units and may be changed with the <STRONG CLASS="Bold">
-balances</STRONG> identifier. If <STRONG CLASS="Bold">
-uncertainty</STRONG> is not entered, the program uses 0.05. The default uncertainty limits can be overridden for individual elements or element valence states using <STRONG CLASS="Bold">
-balances</STRONG> identifier. Optionally, <STRONG CLASS="Bold">
uncertainty, uncertainties</STRONG>, <STRONG CLASS="Bold">
-u</STRONG>[<STRONG CLASS="Bold">
ncertainty</STRONG>], or <STRONG CLASS="Bold">
-u</STRONG>[<STRONG CLASS="Bold">
ncertainties</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254862"></A><EM CLASS="Emphasis">
list of uncertainty limits</EM>
--List of default uncertainty limits that are applied to each solution in the order given by <STRONG CLASS="Bold">
-solutions</STRONG>. The first uncertainty limit in the list is applied to all the element and element valence states in the first solution listed in <STRONG CLASS="Bold">
-solutions</STRONG>. The second uncertainty limit in the list is applied to all the element and element valence states in the second solution listed in <STRONG CLASS="Bold">
-solutions</STRONG> and so on. If fewer uncertainty limits are entered than the number of solutions, the final uncertainty limit in the list is used for the remaining solutions. Thus, if only one uncertainty limit is entered, it is applied to all solutions. The uncertainty limit may have two forms: (1) if the uncertainty limit is positive, it is interpreted as a fraction to be used to calculate the uncertainty limit for each element or element valence state; a value of 0.02 indicates an uncertainty limit of 2 percent of the moles of each element in solution will be used, and (2) if the uncertainty limit is negative, it is interpreted as an absolute value in moles to use for each mole-balance constraint. The second form is rarely used in <STRONG CLASS="Bold">
-uncertainty</STRONG> input. In this example data block, the default uncertainty limit for the first solution is set to 0.02, which indicates that the concentration of each element in the first solution (solution 10) is allowed to vary up to plus or minus 2 percent, and a default uncertainty limit of 4 percent will be applied to each element and valence state in the second solution (solution 3) and all remaining solutions (solution 5 in this case). </P>
<P CLASS="Body-indent">
<A NAME="pgfId-254863"></A>Line 3: <STRONG CLASS="Bold">
-phases</STRONG></P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254864"></A><STRONG CLASS="Bold">
-phases</STRONG>--Identifier that indicates a list of phases to be used in inverse modeling follows on succeeding lines. Optionally, <STRONG CLASS="Bold">
phase</STRONG>,<STRONG CLASS="Bold">
 phase_data</STRONG>, <STRONG CLASS="Bold">
-p</STRONG>[<STRONG CLASS="Bold">
hases</STRONG>], or <STRONG CLASS="Bold">
-p</STRONG>[<STRONG CLASS="Bold">
hase_data</STRONG>]. Note the hyphen is required in <STRONG CLASS="Bold">
-phases</STRONG> to avoid conflict with the keyword <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG>.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254865"></A>Line 4: <EM CLASS="Emphasis">
phase name </EM>
[<STRONG CLASS="Bold">
force</STRONG>] [<STRONG CLASS="Bold">
(dissolve</STRONG> or <STRONG CLASS="Bold">
precipitate)</STRONG>] [<EM CLASS="Emphasis">
list of isotope name, isotope ratio, isotope uncertainty limit</EM>
]</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254866"></A><EM CLASS="Emphasis">
phase name</EM>
--Name of a phase to be used in inverse modeling. The phase must be defined in <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG> input or it must be a charge-balanced exchange species defined in <STRONG CLASS="Bold">
<A HREF="final-41.html#60716" CLASS="XRef">EXCHANGE_SPECIES</A></STRONG> input. Any phases and exchange species defined in the database file or in the current or previous simulations are available for inverse modeling. Only the chemical reaction in <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG> or <STRONG CLASS="Bold">
<A HREF="final-41.html#60716" CLASS="XRef">EXCHANGE_SPECIES</A></STRONG> input is important; the log <EM CLASS="Emphasis">
K</EM>
 is not used in inverse-modeling calculations.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254867"></A><STRONG CLASS="Bold">
force</STRONG>--The phase is included (&quot;forced&quot;) to be in the range calculation (see line 9) whether or not the phase mole transfer is nonzero. This will give another degree of freedom to the range calculation for models that do not include the phase and the resulting range of mole transfers may be larger. The order of this option following the phase name is not important. Optionally, <STRONG CLASS="Bold">
f</STRONG>[<STRONG CLASS="Bold">
orce</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254868"></A><STRONG CLASS="Bold">
dissolve</STRONG> or <STRONG CLASS="Bold">
precipitate</STRONG>--The phase may be constrained only to enter the aqueous phase, &quot;<STRONG CLASS="Bold">
dissolve</STRONG>&quot;, or leave the aqueous phase, &quot;<STRONG CLASS="Bold">
precipitate</STRONG>&quot;. Any set of initial letters from these two words are sufficient to define a constraint.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254869"></A><EM CLASS="Emphasis">
list of isotope name</EM>
,<EM CLASS="Emphasis">
 isotope ratio</EM>
,<EM CLASS="Emphasis">
 isotope uncertainty limit</EM>
--Isotopic information for the phase may be defined for one or more isotopes by appending (to line 4) triplets of <EM CLASS="Emphasis">
isotope name</EM>
,<EM CLASS="Emphasis">
 isotope ratio</EM>
,<EM CLASS="Emphasis">
 isotope uncertainty limit</EM>
.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254870"></A><EM CLASS="Emphasis">
isotope name</EM>
--Isotope name written with mass number first followed by element name with no intervening spaces.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254871"></A><EM CLASS="Emphasis">
isotope ratio</EM>
--Isotope ratio for this isotope of this element (<EM CLASS="Emphasis">
isotope name</EM>
) in the phase, frequently permil, but percent or other units can be used. Units must be consistent with the units in which this isotope of the element is defined in <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG> input. </P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254872"></A><EM CLASS="Emphasis">
isotope uncertainty</EM>
--Uncertainty limit for isotope ratio in the phase. Units must be consistent with the units for <EM CLASS="Emphasis">
isotope ratio</EM>
 and units in which this isotope of this element is defined in <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG> input.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254873"></A>Line 5: <STRONG CLASS="Bold">
-balances</STRONG></P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254874"></A><STRONG CLASS="Bold">
-balances</STRONG>--Identifier that indicates a list of element or element-valence-state name follow on succeeding lines. Optionally, <STRONG CLASS="Bold">
bal</STRONG>, <STRONG CLASS="Bold">
balance</STRONG>, <STRONG CLASS="Bold">
balances</STRONG>, or <STRONG CLASS="Bold">
-b</STRONG>[<STRONG CLASS="Bold">
alances</STRONG>].</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254875"></A>Line 6: <EM CLASS="Emphasis">
element or valence state name </EM>
[<EM CLASS="Emphasis">
list of uncertainty limits</EM>
]</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254876"></A><EM CLASS="Emphasis">
element or valence state name</EM>
--Name of an element or element valence state to be included as a mole-balance constraint in inverse modeling. The identifier <STRONG CLASS="Bold">
-balances</STRONG> is used for two purposes: (1) to include mole-balance equations for elements not contained in any of the phases (<STRONG CLASS="Bold">
-phases</STRONG>) and (2) to override the uncertainty limits defined with <STRONG CLASS="Bold">
-uncertainty </STRONG>(or the default uncertainty limits) for elements, element valences states, or pH. Mole-balance equations for all elements that are found in the phases of <STRONG CLASS="Bold">
-phases</STRONG> input are automatically included in inverse modeling with the default uncertainty limits defined by the <STRONG CLASS="Bold">
-uncertainties</STRONG> identifier; mole-balance equations for all valence states of redox elements are included if the element is in any of the phases of <STRONG CLASS="Bold">
-phases</STRONG>. </P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254877"></A><EM CLASS="Emphasis">
list of uncertainty limits</EM>
--List of uncertainty limits for the specified element or element valence-state constraint. It is possible to input an uncertainty limit for <EM CLASS="Emphasis">
element or valence state name</EM>
 for each solution used in inverse modeling (as defined by <STRONG CLASS="Bold">
-solutions</STRONG>). If fewer uncertainty limits are entered than the number of solutions, the final uncertainty limit in the list is used for the remaining solutions. Thus, if only one uncertainty limit is entered, it is used for the given element or element valence state for all solutions. The uncertainty limit for pH must be given in standard units. Thus, the uncertainty limit in pH given on line 6a is 0.1 pH units for all solutions. The uncertainty limits for elements and element valence states (but not for pH) may have two forms: (1) if the uncertainty limit is positive, it is interpreted as a fraction that when multiplied times the moles in solution gives the uncertainty limit in moles. A value of 0.02 would indicate an uncertainty limit of 2 percent of the moles in solution; and (2) if the uncertainty limit is negative, it is interpreted as an absolute value in moles to use for the solution in the mole-balance equation for <EM CLASS="Emphasis">
element </EM>
or<EM CLASS="Emphasis">
 valence state name</EM>
. In the example data block, line 6b, the uncertainty limit for calcium in solution 10 is 1 percent of the moles of calcium in solution 10. The uncertainty limit for calcium in solution 3 and 5 is 0.005 moles. The uncertainty limit for iron (line 6d) is 5 percent in solution 10, 10 percent in solution 3, and 20 percent in solution 5.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254878"></A>Line 7: <STRONG CLASS="Bold">
-isotopes </STRONG></P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254879"></A><STRONG CLASS="Bold">
-isotopes</STRONG>--Identifier that specifies mole balance for the isotopes listed on succeeding lines will be included in the calculation. Optionally, <STRONG CLASS="Bold">
isotopes</STRONG> or <STRONG CLASS="Bold">
-i</STRONG>[<STRONG CLASS="Bold">
sotopes</STRONG>].</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254880"></A>Line 8: <EM CLASS="Emphasis">
isotope_name, list of uncertainty limits</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254881"></A><EM CLASS="Emphasis">
isotope_name</EM>
--Name of an isotope for which mole balance is desired. The name must be written with mass number first followed by element name or redox state with no intervening spaces.</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254882"></A><EM CLASS="Emphasis">
list of uncertainty limits</EM>
--List of uncertainty limits for the specified isotope for the solutions used in inverse modeling (as defined by <STRONG CLASS="Bold">
-solutions</STRONG>). If fewer uncertainty limits are entered than the number of solutions, the final uncertainty limit in the list is used for the remaining solutions. Thus, if only one uncertainty limit is entered, it is used for the given isotope for all solutions. In the example data block, the uncertainty limit for carbon-13 (line 8a) is 0.05 permil in solution 10, 0.1 permil in solution 3, and 0.05 permil in solution 5. The uncertainty limit for sulfur-34 (line 8b) is 1 permil in all solutions. Units of the uncertainty limits for an isotope must be consistent with units used to define the isotope in <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG> input and with the units used to define isotope values under the <STRONG CLASS="Bold">
-phases </STRONG>identifier (line 4).</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254883"></A>Line 9: <STRONG CLASS="Bold">
-range </STRONG>[<EM CLASS="Emphasis">
maximum</EM>
]</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254884"></A><STRONG CLASS="Bold">
-range</STRONG>--Identifier that specifies that ranges in mole transfer for each phase in each model should be calculated. The range in mole transfer for a phase is the minimum and maximum mole transfers that can be attained for a given inverse model by varying element concentrations within their uncertainty limits. The calculation of these ranges is time consuming, but provides valuable information. In the interest of expediency, it is suggested that models are first identified without using the <STRONG CLASS="Bold">
-range</STRONG> identifier and the mole transfers checked for plausibility and geochemical consistency with any additional information such as saturation indices, isotopic compositions, and mineral textures; then the calculation is rerun with the <STRONG CLASS="Bold">
-range</STRONG> identifier. Any phase with the <STRONG CLASS="Bold">
force</STRONG> option will be included for each range calculation even if the inverse model does not contain this phase. Optionally, <STRONG CLASS="Bold">
range</STRONG>, <STRONG CLASS="Bold">
ranges</STRONG>, or <STRONG CLASS="Bold">
-r</STRONG>[<STRONG CLASS="Bold">
anges</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254885"></A><EM CLASS="Emphasis">
maximum</EM>
--The maximum value for the range is calculated by minimizing the difference between the value of <EM CLASS="Emphasis">
maximum</EM>
 and the calculated mole transfer of the phase or the solution fraction. The minimum value of the range is calculated by minimizing the difference between the negative of the value of <EM CLASS="Emphasis">
maximum</EM>
 and the calculated mole transfer of the phase or the solution fraction. In some evaporation problems, the solution fraction could be greater than 1000 (over 1000-fold evaporative concentration). In these problems, the default value is not large enough and a larger value of maximum should be entered. Default is 1000. </P>
<P CLASS="Body-indent">
<A NAME="pgfId-254886"></A>Line 10: <STRONG CLASS="Bold">
-minimal</STRONG></P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254887"></A><STRONG CLASS="Bold">
-minimal</STRONG>--Identifier that specifies that models be reduced to the minimum number of phases that can satisfy all of the constraints within the specified uncertainty limits. Note that two minimal models may have different numbers of phases; minimal models imply that no model with any proper subset of phases and solutions could be found. The <STRONG CLASS="Bold">
-minimal</STRONG> identifier minimizes the number of calculations that will be performed and produces the models that contain the most essential geochemical reactions. However, models that are not minimal may also be of interest, so the use of this option is left to the discretion of the user. In the interest of expediency, it is suggested that models are first identified using the <STRONG CLASS="Bold">
-minimal </STRONG>identifier, checked for plausibility and geochemical consistency, and then rerun without the <STRONG CLASS="Bold">
-minimal </STRONG>identifier. Optionally, <STRONG CLASS="Bold">
minimal</STRONG>, <STRONG CLASS="Bold">
minimum</STRONG>, <STRONG CLASS="Bold">
-m</STRONG>[<STRONG CLASS="Bold">
inimal</STRONG>], or <STRONG CLASS="Bold">
-m</STRONG>[<STRONG CLASS="Bold">
inimum</STRONG>].</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254888"></A>Line 11: <STRONG CLASS="Bold">
-tolerance </STRONG><EM CLASS="Emphasis">
tol</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-320142"></A><STRONG CLASS="Bold">
-tolerance</STRONG>--Identifier that indicates a tolerance for the optimizing solver is to be given. Optionally, <STRONG CLASS="Bold">
tolerance</STRONG> or <STRONG CLASS="Bold">
-t</STRONG>[<STRONG CLASS="Bold">
olerance</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-320143"></A><EM CLASS="Emphasis">
tol</EM>
--Tolerance used by the optimizing solver. The value of <EM CLASS="Emphasis">
tol</EM>
 should be greater than the greatest calculated mole transfer or solution fraction multiplied by 1e-15. The default value is adequate unless very large mole transfers (greater than 1000 moles) or solution fractions (greater than 1000-fold evaporative concentration) occur. In these cases, a larger value of <EM CLASS="Emphasis">
tol</EM>
 may be needed. Essentially, a value less than <EM CLASS="Emphasis">
tol</EM>
 is treated as zero. Thus, the value of <EM CLASS="Emphasis">
tol</EM>
 should not be too large or significantly different concentrations will be treated as equal. Uncertainty limits less than <EM CLASS="Emphasis">
tol</EM>
 are assumed to be zero. Default is approximately 1e-10 for default compilation, but may be smaller if the program is compiled using long double precision. </P>
<P CLASS="Body-indent">
<A NAME="pgfId-254891"></A>Line 12: <STRONG CLASS="Bold">
-force_solutions </STRONG><EM CLASS="Emphasis">
list of </EM>
(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254892"></A><STRONG CLASS="Bold">
-force_solutions</STRONG>--Identifier that indicates one or more solutions will be forced to be included in all range calculations. Optionally, <STRONG CLASS="Bold">
force_solution</STRONG>, <STRONG CLASS="Bold">
force_solutions</STRONG>, or <STRONG CLASS="Bold">
-force_</STRONG>[<STRONG CLASS="Bold">
solutions</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254893"></A><EM CLASS="Emphasis">
list of </EM>
(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--<STRONG CLASS="Bold">
True</STRONG> values include initial solutions in all range calculations. It is possible to input a <STRONG CLASS="Bold">
True</STRONG> or <STRONG CLASS="Bold">
False</STRONG> value for each initial solution used in inverse modeling. If fewer values are entered than the number of initial solutions (<STRONG CLASS="Bold">
-solutions</STRONG> identifier), then the final value in the list is used for the remaining initial solutions. Thus, if only one <STRONG CLASS="Bold">
True</STRONG> or <STRONG CLASS="Bold">
False</STRONG> value is entered, it is used for all initial solutions. In the example data block (line 12), solution 10 will be included in all range calculations for all models; even if a model does not include solution 10 (mixing fraction of zero), the range calculation will allow for nonzero mixing fractions of solution 10 in calculating the minimum and maximum mole transfers of phases. Solutions 3 and 5 will be included in range calculations only for models that have a nonzero mixing fractions for these solutions.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254894"></A>Line 13: <STRONG CLASS="Bold">
-uncertainty_water </STRONG><EM CLASS="Emphasis">
moles</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254895"></A><STRONG CLASS="Bold">
-uncertainty_water</STRONG>--Identifier for uncertainty term in the water-balance equation. For completeness in the formulation of inverse modeling, an uncertainty term can be added to the water balance equation. The sum of the moles of water derived from each initial solution must balance the moles of water in the final solution plus or minus <EM CLASS="Emphasis">
moles </EM>
of water. Optionally, <STRONG CLASS="Bold">
uncertainty_water</STRONG>, <STRONG CLASS="Bold">
u_water</STRONG>, <STRONG CLASS="Bold">
-uncertainty_</STRONG>[<STRONG CLASS="Bold">
water</STRONG>], or <STRONG CLASS="Bold">
-u_</STRONG>[<STRONG CLASS="Bold">
water</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254896"></A><EM CLASS="Emphasis">
moles</EM>
--Uncertainty term for the water-balance equation. Default is 0.0.</P>
<P CLASS="Body-indent">
<A NAME="pgfId-254897"></A>Line 14: <STRONG CLASS="Bold">
-mineral_water </STRONG>[(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)]</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254898"></A><STRONG CLASS="Bold">
-mineral_water</STRONG>--Identifier to include or exclude water derived from minerals in the water-balance equation. Normally, water from minerals should be included in the water-balance equation. Sometimes unreasonable models are generated that create all the water in solution by dissolution and precipitation of minerals. Setting <STRONG CLASS="Bold">
-mineral_water</STRONG> to <STRONG CLASS="Bold">
False</STRONG> removes the terms for water derived from minerals from the water-balance equation, which eliminates these unreasonable models. However, removing these terms may introduce errors in some models by ignoring water derived from minerals (for example water from dissolution of gypsum) that should be considered in the water-balance equation. Optionally, <STRONG CLASS="Bold">
mineral_water</STRONG> or <STRONG CLASS="Bold">
-mine</STRONG>[<STRONG CLASS="Bold">
ral_water</STRONG>].</P>
<P CLASS="Body1-indent">
<A NAME="pgfId-254899"></A>(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--<STRONG CLASS="Bold">
True</STRONG> includes terms for water derived from minerals in the water-balance equation, <STRONG CLASS="Bold">
False</STRONG> excludes these terms from the equation. Default is <STRONG CLASS="Bold">
True</STRONG>.</P>
</DIV>
<DIV>
<H3 CLASS="FM4thOrderHeading">
<A NAME="pgfId-254900"></A><STRONG CLASS="Bold">
Notes</STRONG></H3>
<P CLASS="BodyText">
<A NAME="pgfId-254901"></A>Writing of inverse models to the output file can be enabled or disabled with the <STRONG CLASS="Bold">
-inverse</STRONG> identifier in the <STRONG CLASS="Bold">
<A HREF="final-49.html#92102" CLASS="XRef">PRINT</A></STRONG> data block. Inverse models can be written to the selected-output file by including the <STRONG CLASS="Bold">
-inverse</STRONG> identifier in the <STRONG CLASS="Bold">
<A HREF="final-54.html#20239" CLASS="XRef">SELECTED_OUTPUT</A></STRONG> data block. For each model that is found the following values are written to the selected-output file: (1) the sum of residuals, sum of each residual divided by its uncertainty limit, and the maximum fractional error, (2) for each solution--the mixing fraction, minimum mixing fraction, and maximum mixing fraction, and (3) for each phase in the list of phases (<STRONG CLASS="Bold">
-phase</STRONG> identifier)--the mole transfer, minimum mole transfer, and maximum mole transfer. Mixing fractions and mole transfers are zero for solutions and phases not included in the model. Minimum and maximum values are 0.0 unless the <STRONG CLASS="Bold">
-range</STRONG> calculation is performed. The result of printing to the selected-output file is columns of numbers, where each row represents a mole-balance model.</P>
<P CLASS="BodyText">
<A NAME="pgfId-320301"></A>The numerical method for inverse modeling <EM CLASS="Emphasis">
requires</EM>
 consideration of the uncertainties related to aqueous concentrations. Uncertainties related to mineral compositions may be equally important, but are not automatically considered. To consider uncertainties in mineral compositions, it is possible to include two (or more) phases (under <STRONG CLASS="Bold">
-phases</STRONG> identifier and definitions in <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG> data block) that represent end-member compositions for minerals. The inverse modeling calculation will attempt to find models considering the entire range of mineral composition. Usually, each model that is found will include only one or the other of the end-members, but any mixture of inverse models, which in this case would represent mixtures of the end members, is also a valid inverse model.</P>
<P CLASS="BodyText">
<A NAME="pgfId-269243"></A>The possibility of evaporation or dilution can be included in inverse modeling by including water as one of the phases under the <STRONG CLASS="Bold">
-phases </STRONG>identifier [<STRONG CLASS="Bold">
H2O(g)</STRONG> for databases distributed with program]. The mole transfer of this phase will affect only the water-balance equation. If the mole transfer is positive, dilution is simulated; if negative, evaporation is simulated (see example <A HREF="final-86.html#83128" CLASS="XRef">17</A> in &quot;Examples&quot;).</P>
<P CLASS="BodyText">
<A NAME="pgfId-269244"></A>If <STRONG CLASS="Bold">
-uncertainty</STRONG> is not included, a default uncertainty limit of 0.05 (5 percent) is used for elements and 0.05 for pH. Default uncertainty limits, specified by <STRONG CLASS="Bold">
-uncertainty</STRONG>, will almost always be specified as positive numbers, indicating fractional uncertainty limits. A default uncertainty limit specified by a negative number, indicating a fixed molal uncertainty limit for all elements in solution, is usually not reasonable because of wide ranges in concentrations among elements present in solution.</P>
<P CLASS="BodyText">
<A NAME="pgfId-320334"></A>No mole-balance equation is used for pH and the uncertainty limit in pH only affects the mole balance on alkalinity. Alkalinity is assumed to co-vary with pH and carbon and an equation relating the uncertainty term for alkalinity and the uncertainty terms for pH and carbon is included in the inverse model (see &quot;Equations and Numerical Methods for Inverse Modeling&quot;).</P>
<P CLASS="BodyText">
<A NAME="pgfId-320341"></A>All phase names and phase stoichiometries must be defined through <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG> or <STRONG CLASS="Bold">
<A HREF="final-41.html#60716" CLASS="XRef">EXCHANGE_SPECIES</A></STRONG> input. Line 4c and 4d are included to allow ion-exchange reactions in the inverse model; exchange species with the names CaX<SUB CLASS="Subscript">
2</SUB>
 and NaX are among the exchange species defined in the default database and are thus available for use in inverse modeling. In the example data block and in the examples problems (<A HREF="final-85.html#75769" CLASS="XRef">16</A>, <A HREF="final-86.html#83128" CLASS="XRef">17</A>, and <A HREF="final-87.html#35722" CLASS="XRef">18</A>), the composition of the phases is assumed to be relatively simple. In real systems, the composition of reactive phases--for example pyroxenes, amphiboles, or alumino-silicate glasses--may be complex. Application of inverse modeling in these systems will require knowledge of specific mineral compositions or appropriate simplification of the mineral stoichiometries.</P>
<P CLASS="BodyText">
<A NAME="pgfId-254906"></A>By default, mole-balance equations for every element that occurs in the phases listed in <STRONG CLASS="Bold">
-phases</STRONG> input are included in the inverse-modeling formulation. If an element is redox active, then mole-balance equations for all valence states of that element are included. The <STRONG CLASS="Bold">
-balances</STRONG> identifier is necessary to define (1) uncertainty limits for pH, elements, or element valence states that are different from the default uncertainty limits or (2) mole-balance equations for elements not included in the phases. Mole-balance equations for alkalinity and electrons are always included in the inverse model. In some solutions, such as pure water or pure sodium chloride solutions, the alkalinity may be small (less than 1e-7) in both initial and final solutions. In this case, it may be necessary to use large (relative to 1e-7 equivalents) uncertainty limits (+1.0 or -1e-6) to obtain a mole balance on alkalinity. For most natural waters, alkalinity will not be small in both solutions and special handling of the alkalinity uncertainty will not be necessary (note alkalinity is a negative number in acid solutions). Uncertainty limits for electrons are never used because it is always assumed that no free electrons exist in an aqueous solution.</P>
<P CLASS="BodyText">
<A NAME="pgfId-254907"></A>If isotope mole balances are used, then (1) isotopic values for the aqueous phases must be defined through the <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG> data block, (2) the <STRONG CLASS="Bold">
-isotopes</STRONG> identifier must be used in the <STRONG CLASS="Bold">
INVERSE_MODELING</STRONG> data block to specify the isotopes for which mole balances are desired and, optionally, the uncertainty limits in isotopic values associated with each solution, and (3) for each phase listed below the <STRONG CLASS="Bold">
-phases </STRONG>identifier of the <STRONG CLASS="Bold">
INVERSE_MODELING</STRONG> data block, isotopic values and uncertainty limits must be defined for each isotope that is contained in the phase. In addition, each phase that contains isotopes must be constrained either to dissolve or to precipitate. Default uncertainty limits for isotopes are given in table <A HREF="final-44.html#17116" CLASS="XRef">5</A>.</P>
<TABLE>
<CAPTION>
<P CLASS="TableTitle">
<A NAME="pgfId-254913"></A>Table 5.<A NAME="17116"></A><STRONG CLASS="Bold">
--</STRONG>Default uncertainty limits for isotopes</P>
</CAPTION>
<TR>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-254917"></A><STRONG CLASS="Bold">
Isotope</STRONG></P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-254919"></A><STRONG CLASS="Bold">
Default<BR>
uncertainty limit</STRONG></P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254921"></A><SUP CLASS="Superscript">
13</SUP>
C</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254923"></A>1 permil PDB </P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254925"></A><SUP CLASS="Superscript">
13</SUP>
C(4)</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254927"></A>1 permil PDB</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254929"></A><SUP CLASS="Superscript">
13</SUP>
C(-4)</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254931"></A>5 permil PDB</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254933"></A><SUP CLASS="Superscript">
34</SUP>
S</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254935"></A>1 permil CDT</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254937"></A><SUP CLASS="Superscript">
34</SUP>
S(5)</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254939"></A>1 permil CDT</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254941"></A><SUP CLASS="Superscript">
34</SUP>
S(-2)</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254943"></A>5 permil CDT</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254945"></A><SUP CLASS="Superscript">
2</SUP>
H</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254947"></A>1 permil VSMOW</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254949"></A><SUP CLASS="Superscript">
18</SUP>
O</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254951"></A>0.1 permil VSMOW</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254953"></A><SUP CLASS="Superscript">
87</SUP>
Sr</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody9ptLeft">
<A NAME="pgfId-254955"></A>0.01 ratio</P>
</TD>
</TR>
</TABLE>
<P CLASS="BodyText">
<A NAME="pgfId-254956"></A>The options <STRONG CLASS="Bold">
-minimal</STRONG> and <STRONG CLASS="Bold">
-range</STRONG> affect the speed of the calculations. The fastest calculation is one that includes the <STRONG CLASS="Bold">
-minimal</STRONG> identifier and does not include <STRONG CLASS="Bold">
-range</STRONG>. The slowest calculation is one that does not include <STRONG CLASS="Bold">
-minimal</STRONG> and does include <STRONG CLASS="Bold">
-range</STRONG>.</P>
<P CLASS="BodyText">
<A NAME="pgfId-254957"></A>The <STRONG CLASS="Bold">
force</STRONG> option for a phase in <STRONG CLASS="Bold">
-phases</STRONG> and the <STRONG CLASS="Bold">
-force_solutions</STRONG> identifier affects only the range calculation; it does not affect the number of models that are found. When the <STRONG CLASS="Bold">
-range</STRONG> identifier is specified and a model is found by the numerical method, then the model is augmented by any phase for which <STRONG CLASS="Bold">
force</STRONG> is specified and by any solution for which <STRONG CLASS="Bold">
-force_solutions</STRONG> is <STRONG CLASS="Bold">
true</STRONG>; the range calculation is performed with the augmented model. The effect of these options is to calculate wider ranges for mole transfers for some models. If every phase and every solution were forced to be in the range calculation, then the results of the range calculation would be the same for every model and the results would be the maximum possible ranges of mole transfer for any models that could be derived from the given set of solutions and phases.</P>
</DIV>
<DIV>
<H3 CLASS="FM4thOrderHeading">
<A NAME="pgfId-254958"></A><STRONG CLASS="Bold">
Example problems</STRONG></H3>
<P CLASS="BodyText">
<A NAME="pgfId-254959"></A>The keyword <STRONG CLASS="Bold">
INVERSE_MODELING </STRONG>is used in example problems <A HREF="final-85.html#75769" CLASS="XRef">16</A>, <A HREF="final-86.html#83128" CLASS="XRef">17</A>, and <A HREF="final-87.html#35722" CLASS="XRef">18</A>.</P>
</DIV>
<DIV>
<H3 CLASS="FM4thOrderHeading">
<A NAME="pgfId-254960"></A><STRONG CLASS="Bold">
Related keywords</STRONG></H3>
<P CLASS="BodyText">
<A NAME="pgfId-254979"></A><STRONG CLASS="Bold">
<A HREF="final-41.html#60716" CLASS="XRef">EXCHANGE_SPECIES</A></STRONG>, <STRONG CLASS="Bold">
<A HREF="final-48.html#84418" CLASS="XRef">PHASES</A></STRONG>, <STRONG CLASS="Bold">
<A HREF="final-49.html#92102" CLASS="XRef">PRINT</A></STRONG>, <STRONG CLASS="Bold">
<A HREF="final-54.html#20239" CLASS="XRef">SELECTED_OUTPUT</A></STRONG>, <STRONG CLASS="Bold">
<A HREF="final-56.html#89789" CLASS="XRef">SOLUTION</A></STRONG>, and <STRONG CLASS="Bold">
<A HREF="final-53.html#81857" CLASS="XRef">SAVE</A></STRONG>.</P>
</DIV>
<HR><P> | <A HREF="final-45.html">Next</A>|| <A HREF="final-43.html">Previous</A> || <A HREF="final.html">Top</A>  | </P>

</BODY>
</HTML>

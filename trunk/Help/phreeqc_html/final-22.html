<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="final.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE> The Advection-Reaction-Dispersion Equation</TITLE>
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<HR><P> | <A HREF="final-23.html">Next</A>|| <A HREF="final-21.html">Previous</A> || <A HREF="final.html">Top</A>  | </P>

</DIV>
<H1 CLASS="FM2dOrderHeading">
<A NAME="pgfId-252121"></A><STRONG CLASS="Bold">
The Advection-Reaction-Dispersion Equation</STRONG></H1>
<P CLASS="BodyText">
<A NAME="pgfId-252125"></A>Conservation of mass for a chemical that is transported (fig. <A HREF="final-22.html#15103" CLASS="XRef">1</A>) yields the advection-reaction-dispersion (ARD) equation:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252130"></A><A NAME="39610"></A><IMG SRC="final-484.jpg" ALIGN="MIDDLE">
,	(107)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-363872"></A>where <EM CLASS="Emphasis">
C</EM>
 is concentration in water (mol/kgw), <EM CLASS="Emphasis">
t</EM>
 is time (s), <EM CLASS="Emphasis">
v</EM>
 is pore water flow velocity (m/s), <EM CLASS="Emphasis">
x</EM>
 is distance (m), <EM CLASS="Emphasis">
D</EM>
<SUB><EM>
L</EM></SUB>
 is the hydrodynamic dispersion coefficient [m<SUP CLASS="Superscript">
2</SUP>
/s, <IMG SRC="final-485.jpg" ALIGN="MIDDLE">
, with <EM CLASS="Emphasis">
D</EM>
<SUB><EM>
e</EM></SUB>
 the effective diffusion coefficient, and <IMG SRC="final-486.jpg" ALIGN="MIDDLE">
 the dispersivity (m)], and <EM CLASS="Emphasis">
q</EM>
 is concentration in the solid phase (expressed as mol/kgw in the pores). The term <IMG SRC="final-487.jpg" ALIGN="MIDDLE">
 represents advective transport, <IMG SRC="final-488.jpg" ALIGN="MIDDLE">
 represents dispersive transport, and <IMG SRC="final-489.jpg" ALIGN="MIDDLE">
 is the change in concentration in the solid phase due to reactions (<EM CLASS="Emphasis">
q</EM>
 in the same units as <EM CLASS="Emphasis">
C</EM>
). The usual assumption is that <EM CLASS="Emphasis">
v</EM>
 and <EM CLASS="Emphasis">
D</EM>
<SUB><EM>
L</EM></SUB>
 are equal for all solute species, so that <EM CLASS="Emphasis">
C</EM>
 can be the total dissolved concentration for an element, including all redox species.</P>
<DIV>
<MAP NAME="final-490">
</MAP>
<IMG SRC="final-490.jpg" USEMAP="#final-490">
</DIV>
<P CLASS="Fig-cap">
<A NAME="pgfId-363952"></A>Figure 1.<A NAME="15103"></A><STRONG CLASS="Bold">
--</STRONG>Terms in the advection-reaction-dispersion equation.</P>
<P CLASS="BodyText">
<A NAME="pgfId-452585"></A>The transport part of equation <A HREF="final-22.html#39610" CLASS="XRef">107</A> is solved with an explicit finite difference scheme that is forward in time, central in space for dispersion, and upwind for advective transport. The chemical interaction term <IMG SRC="final-491.jpg" ALIGN="MIDDLE">
 for each element is calculated separately from the transport part for each time step and is the sum of all equilibrium and non-equilibrium reaction rates. The numerical approach follows the basic components of the ARD equation in a split-operator scheme (Press and others, 1992; Yanenko, 1971). With each time step, first advective transport is calculated, then all equilibrium and kinetically controlled chemical reactions, thereafter dispersive transport, which is followed again by calculation of all equilibrium and kinetically controlled chemical reactions. The scheme differs from the majority of other hydrogeochemical transport models (Yeh and Tripathi, 1989) in that kinetic and equilibrium chemical reactions are calculated both after the advection step and after the dispersion step. This reduces numerical dispersion and the need to iterate between chemistry and transport.</P>
<P CLASS="BodyText">
<A NAME="pgfId-252217"></A>A major advantage of the split-operator scheme is that numerical accuracy and stability can be obtained by adjusting time step to grid size for the individual parts of the equation. Numerical dispersion is minimized by always having the following relationship between time and distance discretization:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252222"></A><A NAME="13582"></A><IMG SRC="final-492.jpg" ALIGN="MIDDLE">
,	(108)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252229"></A>where <IMG SRC="final-493.jpg" ALIGN="MIDDLE">
 is the time step for advective transport, and <IMG SRC="final-494.jpg" ALIGN="MIDDLE">
 is the cell length. Numerical instabilities (oscillations) in the calculation of diffusion/dispersion are eliminated with the constraint:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252234"></A><A NAME="35694"></A><IMG SRC="final-495.jpg" ALIGN="MIDDLE">
,	(109)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252241"></A>where <IMG SRC="final-496.jpg" ALIGN="MIDDLE">
 is the time step (s) for dispersive/diffusive transport calculations. The two conditions of equation <A HREF="final-22.html#13582" CLASS="XRef">108</A> and <A HREF="final-22.html#35694" CLASS="XRef">109</A> are the Courant condition for advective transport and the Von Neumann criterion for dispersive transport calculations, respectively (for example, Press and others, 1992). Numerical dispersion is in many cases negligible when <IMG SRC="final-497.jpg" ALIGN="MIDDLE">
, because physical dispersive transport is then equally or more important than advective transport. When a fine grid is used to reduce numerical dispersion, the time step for dispersive transport calculations (equation <A HREF="final-22.html#35694" CLASS="XRef">109</A>) may become smaller than the time step for advective calculations (equation <A HREF="final-22.html#13582" CLASS="XRef">108</A>), because the first has quadratic dependence on grid size. The conflict is solved by multiple dispersion time steps such that <IMG SRC="final-498.jpg" ALIGN="MIDDLE">
, and calculating chemical reactions after each of the dispersion time steps. For input to PHREEQC, a time step must be defined which equals the advection time step <IMG SRC="final-499.jpg" ALIGN="MIDDLE">
, or, if diffusion is modeled, equals the diffusion period. Furthermore, the number of <EM CLASS="Emphasis">
shifts</EM>
 must be defined, which is the number of advection time steps (or diffusion periods) to be calculated.</P>
<P CLASS="BodyText">
<A NAME="pgfId-252257"></A>Dispersive transport in a central difference scheme is essentially mixing of cells. A mixing factor <EM CLASS="Emphasis">
mixf</EM>
 is defined as</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252262"></A><A NAME="12018"></A><IMG SRC="final-500.jpg" ALIGN="MIDDLE">
,	(110)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252263"></A>where <EM CLASS="Emphasis">
n</EM>
 is a positive integer. The restriction is that never more is mixed out of a cell than stays behind, that is, <EM CLASS="Emphasis">
mixf</EM>
 must be less than 1/3 as follows from equation <A HREF="final-22.html#35694" CLASS="XRef">109</A>. When, according to equation <A HREF="final-22.html#12018" CLASS="XRef">110</A> with <EM CLASS="Emphasis">
n</EM>
 = 1, <EM CLASS="Emphasis">
mixf</EM>
 is greater than 1/3, the value of <EM CLASS="Emphasis">
n</EM>
 is increased such that <EM CLASS="Emphasis">
mixf</EM>
 is less than or equal to 1/3. The dispersion time step is then <IMG SRC="final-501.jpg" ALIGN="MIDDLE">
 and <EM CLASS="Emphasis">
n</EM>
 mixes are performed. </P>
<P CLASS="BodyText">
<A NAME="pgfId-252273"></A>The numerical scheme has been checked by comparison with analytical solutions for simple cases with linear exchange. Linear exchange results when the exchange coefficient for the exchange half-reaction is equal for two homovalent cations. It gives a linear retardation <EM CLASS="Emphasis">
R</EM>
 = 1 + <EM CLASS="Emphasis">
CEC / C</EM>
, where <EM CLASS="Emphasis">
CEC</EM>
 is the cation exchange capacity, expressed in mol/kgw. In the following example, a 130 m flow tube contains water with an initial concentration <EM CLASS="Emphasis">
C</EM>
(<EM CLASS="Emphasis">
x</EM>
,0) = <EM CLASS="Emphasis">
C</EM>
<SUB><EM>
i</EM></SUB>
 = 0. The displacing solution has concentration <EM CLASS="Emphasis">
C</EM>
 = <EM CLASS="Emphasis">
C</EM>
<SUB CLASS="Subscript">
0</SUB>
 = 1 mmol/kgw, and the pore-water flow velocity is <EM CLASS="Emphasis">
v</EM>
 = 15 m/year. The dispersivity is <IMG SRC="final-502.jpg" ALIGN="MIDDLE">
 m, and the effective diffusion coefficient is <EM CLASS="Emphasis">
D</EM>
<SUB><EM>
e</EM></SUB>
 = 0 m<SUP CLASS="Superscript">
2</SUP>
/s. The profile is given after 4 years for two chemicals, one with <EM CLASS="Emphasis">
R</EM>
 = 1 (Cl<SUP CLASS="Superscript">
-</SUP>
) and the other with <EM CLASS="Emphasis">
R</EM>
 = 2.5 (Na<SUP CLASS="Superscript">
+</SUP>
).</P>
<P CLASS="BodyText">
<A NAME="pgfId-252274"></A>Two boundary conditions can be considered for this problem. One entails a flux or third type boundary condition at <EM CLASS="Emphasis">
x</EM>
 = 0:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252278"></A><IMG SRC="final-503.jpg" ALIGN="MIDDLE">
.	(111)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252279"></A>This boundary condition is appropriate for laboratory columns with inlet tubing much smaller than the column cross section. The solution for the ARD equation is then (Lindstrom and others, 1967):</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252283"></A><IMG SRC="final-504.jpg" ALIGN="MIDDLE">
,	(112)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252287"></A>where, with <IMG SRC="final-505.jpg" ALIGN="MIDDLE">
:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-365877"></A><IMG SRC="final-506.jpg" ALIGN="MIDDLE">
.	(113)</P>
<P CLASS="BodyText">
<A NAME="pgfId-271727"></A>Figure <A HREF="final-22.html#72725" CLASS="XRef">2</A> shows the comparison for three simulations with different grid spacings, <IMG SRC="final-507.jpg" ALIGN="MIDDLE">
 = 15, 5, and 1.67 m, which correspond with <IMG SRC="final-508.jpg" ALIGN="MIDDLE">
 = 1, 1/3, and 1/9 years, respectively. For Cl<SUP CLASS="Superscript">
-</SUP>
, which has <EM CLASS="Emphasis">
R</EM>
 = 1, the fronts of the three simulations are indistinguishable and in excellent agreement with the analytical solution. For the retarded ion Na<SUP CLASS="Superscript">
+</SUP>
, which has <EM CLASS="Emphasis">
R</EM>
 = 2.5, the average location of the breakthrough curve for all grid spacings is correct and is in agreement with the analytical solution. However, the simulations with coarser grids show a more spread-out breakthrough that is due to numerical dispersion. The finest grid gives the closest agreement with the analytical solution, but requires the most computer time.</P>
<DIV>
<IMG SRC="final-509.jpg">
</DIV>
<P CLASS="Fig-cap">
<A NAME="pgfId-452536"></A>Figure 2.<STRONG CLASS="Bold">
--</STRONG><A NAME="72725"></A>Analytical solution for 1D transport with ion-exchange reactions and flux boundary condition compared with PHREEQC calculations at various grid spacings.</P>
<P CLASS="BodyText">
<A NAME="pgfId-452542"></A>Computer time is primarily dependent on the number of calls to the geochemical subroutines of PHREEQC, and in the absence of kinetic reactions, the number of calls is proportional to (number of cells) x (number of advection steps) x (1 + number of dispersion steps). In this example, <IMG SRC="final-510.jpg" ALIGN="MIDDLE">
 = 0 + 5 x 15 m<SUP CLASS="Superscript">
2</SUP>
/yr. Thus, by equation <A HREF="final-22.html#12018" CLASS="XRef">110</A>, <EM CLASS="Emphasis">
mixf</EM>
 = 1/3, 1, and 3, respectively for the progressively smaller cell sizes. For the 15-meter cell-size (<EM CLASS="Emphasis">
mixf</EM>
 = 1/3), one dispersion step is taken for each advection step; for the 5-meter cell size (<EM CLASS="Emphasis">
mixf</EM>
 = 1), three dispersion steps are taken for each advection step; and for the 1.67-meter cell size (<EM CLASS="Emphasis">
mixf</EM>
 = 3), nine dispersion steps are taken for each advection step. Figure <A HREF="final-22.html#72725" CLASS="XRef">2</A> shows profiles the advective front of Cl (<EM CLASS="Emphasis">
C/C</EM>
<SUB><EM>
0 </EM></SUB>
= 0.5) after 4 years of travel, when it has arrived at 60 m; for the 15-meter cell size, this requires 4 advection steps. The flowtube consists of 9 cells for which geochemical calculations are done for each step; therefore, the number of the reaction calculations is 9 x 4 x (1 + 1) = 72. Larger numbers of cells and advection steps apply for the smaller grids. The number of calls to the reaction calculations for the other two cases is 27 x 12 x (1 + 3) = 1,296; and 81 x 36 x (1 + 9) = 29,160.</P>
<P CLASS="BodyText">
<A NAME="pgfId-252317"></A>The examples given here have linear retardation to enable comparison with analytical solutions. However, linear retardation is subject to large numerical dispersion, and the examples are, in a sense, worst cases with respect to numerical dispersion. In many cases of geochemical interest, the chemical reactions help to counteract numerical dispersion because the reactions tend to sharpen fronts, for example with precipitation/dissolution reactions and displacement chromatography. In other cases, exchange with a less favored ion may give a real, chemical dispersion that exceeds the effects of numerical dispersion.</P>
<P CLASS="BodyText">
<A NAME="pgfId-252318"></A>Another boundary condition is the Dirichlet, or first-type, boundary condition, which involves a constant concentration <EM CLASS="Emphasis">
C</EM>
(0,<EM CLASS="Emphasis">
t</EM>
) at <EM CLASS="Emphasis">
x</EM>
 = 0:</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252322"></A><IMG SRC="final-511.jpg" ALIGN="MIDDLE">
.	(114)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252323"></A>This boundary condition is valid for water infiltrating from a large reservoir in full contact with the underlying soil, for example infiltration from a pond, or diffusion of seawater into underlying sediment. The solution for the ARD equation is in this case (Lapidus and Amundson, 1952):</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-252327"></A><IMG SRC="final-512.jpg" ALIGN="MIDDLE">
,	(115)</P>
<P CLASS="BodyTextFlush">
<A NAME="pgfId-252328"></A>where,</P>
<P CLASS="EquationNumbered">
<A NAME="pgfId-363988"></A><IMG SRC="final-513.jpg" ALIGN="MIDDLE">
.	(116)</P>
<P CLASS="BodyText">
<A NAME="pgfId-452615"></A>Figure <A HREF="final-22.html#19755" CLASS="XRef">3</A> shows the results of three simulations with the same discretizations as the previous transport example. Again, the conservative solute (Cl<SUP CLASS="Superscript">
-</SUP>
 with <EM CLASS="Emphasis">
R</EM>
 = 1) is modeled accurately for all three grid sizes. The retarded chemical (Na<SUP CLASS="Superscript">
+</SUP>
, <EM CLASS="Emphasis">
R</EM>
 = 2.5) shows numerical dispersion for the coarser grids, but again, the average front locations agree. With the constant concentration-boundary condition, the number of dispersion time steps is twice the number for the flux case because of the specified condition at <EM CLASS="Emphasis">
x</EM>
 = 0. Also the effect of the first-type boundary condition is to increase diffusion over the contact surface of the column with the outer solution. The flux of chemical over the boundary is correspondingly larger and the fronts have progressed a few meters further than in figure <A HREF="final-22.html#72725" CLASS="XRef">2</A>. More comparisons of analytical solutions are given in the discussion of example <A HREF="final-80.html#46434" CLASS="XRef">11</A> (breakthrough at the outlet of a column) and example <A HREF="final-81.html#12946" CLASS="XRef">12</A> (diffusion from a constant source).</P>
<DIV>
<IMG SRC="final-514.jpg">
</DIV>
<P CLASS="Fig-cap">
<A NAME="pgfId-452637"></A>Figure 3.<A NAME="19755"></A><STRONG CLASS="Bold">
--</STRONG>Analytical solution for 1D transport with ion-exchange reactions and constant boundary condition compared with PHREEQC calculations at various grid spacings.</P>
<HR><P> | <A HREF="final-23.html">Next</A>|| <A HREF="final-21.html">Previous</A> || <A HREF="final.html">Top</A>  | </P>

</BODY>
</HTML>
